<!-- Mermaid on GitHub Pages (Cayman) -->
<script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
<script>
    document.addEventListener("DOMContentLoaded", () => {
        mermaid.initialize({
            startOnLoad: false,
            securityLevel: 'loose',
            theme: (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) ? 'dark' : 'default'
        });

        // Перетворюємо ```mermaid``` → <div class="mermaid">, щоб Mermaid намалював діаграму
        const blocks = document.querySelectorAll('pre > code.language-mermaid');
        blocks.forEach(code => {
            const pre = code.parentElement;
            const container = document.createElement('div');
            container.className = 'mermaid';
            container.textContent = code.textContent;
            pre.replaceWith(container);
        });

        mermaid.init();
    });
</script>